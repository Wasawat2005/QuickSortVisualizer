<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Quick Sort Visualizer by Group 4</title>
<style>
    body {
        font-family: "Segoe UI", Arial, sans-serif;
        background: #f4f6f9;
        margin: 0;
        padding: 0;
    }
    .container {
        max-width: 900px;
        margin: 40px auto;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        padding: 30px;
    }
    h1 { text-align: center; color: #2c3e50; }
    .subtitle { text-align: center; color: #666; margin-bottom: 30px; }

    .controls {
        display: flex; gap: 10px; justify-content: center; margin-bottom: 25px; flex-wrap: wrap;
    }
    input {
        font-size: 16px; padding: 10px; width: 300px;
        border-radius: 8px; border: 1px solid #ccc;
    }
    button {
        font-size: 16px; padding: 10px 20px; border-radius: 8px; border: none;
        cursor: pointer; background: #3498db; color: #fff;
    }
    button.reset { background: #e74c3c; }

    .box {
        margin-top: 20px; padding: 15px; border-radius: 10px;
        background: #f9fafc; border-left: 5px solid #3498db;
    }
    .array { font-size: 20px; margin-top: 10px; }
    .pivot { color: #e74c3c; font-weight: bold; }

    .history-item {
        margin-top: 8px; padding-left: 10px; border-left: 3px solid #bbb;
        font-size: 15px; color: #333;
    }

    #explain p {
        margin: 6px 0;
        padding-left: 10px;
        border-left: 3px solid #3498db;
        font-size: 15px;
        color: #333;
    }

    .step-indicator { text-align: center; margin-top: 15px; color: #555; }

    @media (max-width: 600px) {
        .container { margin: 20px 10px; padding: 20px; }
        input { width: 100%; }
        button { width: 100%; }
        .array { font-size: 16px; }
    }
</style>
</head>
<body>

<div class="container">
    <h1>Quick Sort – Step by Step</h1>
    <div class="subtitle">by Group 4</div>

    <div class="controls">
        <input id="input" placeholder="e.g. 23 2 14 65 76 88" />
        <button id="mainBtn" onclick="mainButton()">Start</button>
        <button class="reset" onclick="resetAll()">Reset</button>
    </div>

    <div class="box">
        <b>Current Step / Result</b>
        <div class="array" id="current"></div>
    </div>

    <div class="box">
        <b>Previous Steps</b>
        <div id="history"></div>
    </div>

    <div class="box">
        <b>Explanation</b>
        <div id="explain"></div>
    </div>

    <div class="step-indicator" id="step"></div>
</div>

<script>
let steps = [];
let index = 0;
let finalSorted = [];
let started = false;
let finished = false;

function mainButton() {
    if (finished) return; // ถ้าจบแล้ว กดต่อไม่ได้

    if (!started) {
        start();
        if (steps.length > 0) {
            showStep(0);
            index = 1;
            started = true;
            document.getElementById("mainBtn").innerText = "Next Step";
        }
    } else {
        if (index < steps.length) {
            moveToHistory(index - 1);
            showStep(index);
            index++;
        } else {
            finish();
        }
    }
}

function start() {
    const input = document.getElementById("input").value.trim();
    if (!input) return;

    const arr = input.split(/\s+/).map(Number);
    steps = [];
    index = 0;
    finalSorted = [];

    document.getElementById("history").innerHTML = "";
    document.getElementById("explain").innerHTML = "";
    document.getElementById("current").innerHTML = "";
    document.getElementById("step").innerText = "";

    finalSorted = quickSort(arr);
}

function showStep(i) {
    const s = steps[i];
    document.getElementById("current").innerHTML = formatArray(s.left, s.pivot, s.right);

    const p = document.createElement("p");
    p.innerText = `Step ${i + 1}: Choose pivot = ${s.pivot}. Smaller values go left, larger or equal go right.`;
    document.getElementById("explain").appendChild(p);

    document.getElementById("step").innerText = `Step ${i + 1} of ${steps.length}`;
}

function moveToHistory(i) {
    const s = steps[i];
    if (!s) return;
    const div = document.createElement("div");
    div.className = "history-item";
    div.innerHTML = formatArray(s.left, s.pivot, s.right);
    document.getElementById("history").appendChild(div);
}

function finish() {
    moveToHistory(index - 1);
    document.getElementById("current").innerHTML = `<b>Sorted Array:</b> ${finalSorted.join(" ")}`;
    document.getElementById("step").innerText = "Sorting Complete!";
    finished = true;
}

function resetAll() {
    document.getElementById("input").value = "";
    document.getElementById("current").innerHTML = "";
    document.getElementById("history").innerHTML = "";
    document.getElementById("explain").innerHTML = "";
    document.getElementById("step").innerText = "";

    steps = [];
    index = 0;
    finalSorted = [];
    started = false;
    finished = false;

    document.getElementById("mainBtn").innerText = "Start";
}

function formatArray(left, pivot, right) {
    return `${left.join(" ")} | <span class='pivot'>${pivot}</span> | ${right.join(" ")}`;
}

function quickSort(arr) {
    function sort(a) {
        if (a.length <= 1) return a;

        const pivot = a[0];
        const left = [];
        const right = [];

        for (let i = 1; i < a.length; i++) {
            if (a[i] < pivot) left.push(a[i]);
            else right.push(a[i]);
        }

        steps.push({ left: [...left], pivot, right: [...right] });

        return [...sort(left), pivot, ...sort(right)];
    }
    return sort(arr);
}
</script>

</body>
</html>
